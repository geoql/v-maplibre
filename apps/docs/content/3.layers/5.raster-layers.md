---
title: Raster Layers
description: Cloud-Optimized GeoTIFF and satellite imagery visualization
---

::callout{icon="i-lucide-external-link" to="https://mapcn-vue.geoql.in/examples/deckgl-cog" target="_blank"}
**Live Demo** - GPU-accelerated COG visualization with Sentinel-2 imagery
::

## COGLayer

[Live Demo](https://mapcn-vue.geoql.in/examples/deckgl-cog){target="_blank"}

GPU-accelerated Cloud-Optimized GeoTIFF visualization with automatic reprojection.

### Installation

```bash
bun add @developmentseed/deck.gl-raster geotiff-geokeys-to-proj4
```

### Features

- Fully client-side (no server required)
- GPU-accelerated rendering
- Automatic CRS reprojection
- Intelligent tile streaming
- Overview level selection
- Support for multi-band imagery

### Basic Usage

```vue
<script setup lang="ts">
  import { VMap, VLayerDeckglCOG } from '@geoql/v-maplibre';

  const mapOptions = {
    style: 'https://basemaps.cartocdn.com/gl/dark-matter-nolabels-gl-style/style.json',
    center: [31.5, 30.0],
    zoom: 8,
  };

  // Sentinel-2 RGB imagery COG
  const COG_URL = 'https://sentinel-cogs.s3.us-west-2.amazonaws.com/sentinel-s2-l2a-cogs/36/Q/WD/2020/7/S2A_36QWD_20200701_0_L2A/TCI.tif';
</script>

<template>
  <VMap :options="mapOptions" style="height: 500px">
    <VLayerDeckglCOG
      id="cog-layer"
      :geotiff="COG_URL"
      @geotiff-load="(tiff, { geographicBounds }) => console.log('Loaded:', geographicBounds)"
    />
  </VMap>
</template>
```

### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `string` | required | Unique layer identifier |
| `geotiff` | `string \| ArrayBuffer \| Blob` | required | GeoTIFF source URL or data |
| `tileSize` | `number` | `256` | Tile size in pixels |
| `maxZoom` | `number` | - | Maximum zoom level |
| `minZoom` | `number` | `0` | Minimum zoom level |
| `opacity` | `number` | `1` | Layer opacity (0-1) |
| `visible` | `boolean` | `true` | Layer visibility |
| `pickable` | `boolean` | `false` | Enable picking |
| `debug` | `boolean` | `false` | Show debug overlay |

### Events

| Event | Payload | Description |
|-------|---------|-------------|
| `@geotiff-load` | `(tiff, { geographicBounds })` | GeoTIFF loaded with bounds |
| `@click` | `PickingInfo` | Clicked on layer |
| `@hover` | `PickingInfo` | Hovering over layer |

### Fit to Bounds

```vue
<script setup lang="ts">
  import { shallowRef } from 'vue';
  import type { Map } from 'maplibre-gl';

  const mapInstance = shallowRef<Map | null>(null);

  const handleGeotiffLoad = (
    _tiff: unknown,
    { geographicBounds }: { geographicBounds: { west: number; south: number; east: number; north: number } }
  ) => {
    const { west, south, east, north } = geographicBounds;
    mapInstance.value?.fitBounds(
      [[west, south], [east, north]],
      { padding: 40, duration: 1000 }
    );
  };
</script>

<template>
  <VMap :options="mapOptions" @loaded="(map) => mapInstance = map">
    <VLayerDeckglCOG
      id="cog"
      :geotiff="cogUrl"
      @geotiff-load="handleGeotiffLoad"
    />
  </VMap>
</template>
```

### Land Cover Example

[Live Demo](https://mapcn-vue.geoql.in/examples/deckgl-landcover){target="_blank"}

Visualize NLCD land use classification data:

```vue
<VLayerDeckglCOG
  id="landcover"
  :geotiff="nlcdUrl"
  :opacity="0.7"
/>
```

## MosaicLayer

[Live Demo](https://mapcn-vue.geoql.in/examples/deckgl-naip-mosaic){target="_blank"}

Client-side COG mosaic layer that renders multiple Cloud-Optimized GeoTIFFs from STAC items. All rendering happens in the browser with no server required.

### Installation

```bash
bun add @developmentseed/deck.gl-raster @developmentseed/deck.gl-geotiff geotiff flatbush proj4
```

### Features

- Fully client-side mosaicking (no tile server required)
- STAC API integration for discovering imagery
- Multiple render modes: True Color, False Color Infrared, NDVI
- GPU-accelerated rendering with automatic reprojection
- Spatial indexing for efficient tile loading
- Support for 4-band imagery (RGBN)

### Basic Usage

```vue
<script setup lang="ts">
  import { ref, onMounted } from 'vue';
  import {
    VMap,
    VLayerDeckglMosaic,
    type MosaicSource,
    type MosaicRenderMode,
  } from '@geoql/v-maplibre';

  const mapOptions = {
    style: 'https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json',
    center: [-104.9903, 39.7392],
    zoom: 10,
  };

  const renderMode = ref<MosaicRenderMode>('trueColor');
  const stacItems = ref<MosaicSource[]>([]);

  // Fetch STAC items from Microsoft Planetary Computer
  async function fetchSTACItems() {
    const params = {
      collections: 'naip',
      bbox: '-106.6,38.7,-104.6,40.4',
      datetime: '2023-01-01/2023-12-31',
      limit: '1000',
    };

    const response = await fetch(
      'https://planetarycomputer.microsoft.com/api/stac/v1/search?' +
      new URLSearchParams(params)
    );
    const { features } = await response.json();
    stacItems.value = features;
  }

  onMounted(fetchSTACItems);
</script>

<template>
  <VMap :options="mapOptions" style="height: 500px">
    <VLayerDeckglMosaic
      v-if="stacItems.length > 0"
      id="naip-mosaic"
      :sources="stacItems"
      :render-mode="renderMode"
    />
  </VMap>
</template>
```

### Props

| Prop | Type | Default | Description |
|------|------|---------|-------------|
| `id` | `string` | required | Unique layer identifier |
| `sources` | `MosaicSource[]` | required | Array of STAC-like items with bbox and COG asset URLs |
| `renderMode` | `'trueColor' \| 'falseColor' \| 'ndvi' \| 'custom'` | `'trueColor'` | Render mode for band combination |
| `customRenderModules` | `Function` | - | Custom render modules (only used when renderMode is 'custom') |
| `colormapData` | `Uint8ClampedArray` | cfastie | Custom colormap texture data for NDVI (256 RGBA colors) |
| `maxCacheSize` | `number` | `Infinity` | Maximum number of tiles to cache |
| `beforeId` | `string` | - | Insert layer before this layer ID |
| `opacity` | `number` | `1` | Layer opacity (0-1) |
| `visible` | `boolean` | `true` | Layer visibility |
| `pickable` | `boolean` | `false` | Enable picking |

### Events

| Event | Payload | Description |
|-------|---------|-------------|
| `@source-load` | `MosaicSource` | COG source loaded successfully |
| `@error` | `(Error, MosaicSource?)` | Error loading a COG source |
| `@click` | `PickingInfo` | Clicked on layer |
| `@hover` | `PickingInfo` | Hovering over layer |

### Render Modes

| Mode | Description |
|------|-------------|
| `trueColor` | RGB composite (bands 1, 2, 3) |
| `falseColor` | False Color Infrared - NIR, Red, Green (bands 4, 1, 2) - highlights vegetation |
| `ndvi` | Normalized Difference Vegetation Index with cfastie colormap |
| `custom` | Use `customRenderModules` prop for custom band math |

### MosaicSource Type

```typescript
interface MosaicSource {
  bbox: [number, number, number, number]; // [west, south, east, north]
  assets: {
    image: {
      href: string; // URL to the COG file
    };
  };
}
```

This matches the STAC Item format, so you can pass STAC search results directly.

### Supported CRS

The component includes built-in support for:
- EPSG:4326 (WGS84)
- EPSG:3857 (Web Mercator)
- EPSG:26910-26919 (NAD83 / UTM zones 10-19 for continental US)

For other CRS, you'll need to register them with proj4 before using.

## IDW Interpolation Heatmap

[Live Demo](https://mapcn-vue.geoql.in/examples/maplibre-interpolate-heatmap){target="_blank"}

For Inverse Distance Weighting interpolation (temperature, pollution, continuous values), use `maplibre-gl-interpolate-heatmap`:

```bash
bun add maplibre-gl-interpolate-heatmap
```

This is different from deck.gl's density heatmap - it calculates weighted averages rather than point density. See the [live example](https://mapcn-vue.geoql.in/examples/maplibre-interpolate-heatmap) for implementation details.
