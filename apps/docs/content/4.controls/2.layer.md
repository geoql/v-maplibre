---
title: VControlLayer
description: Layer visibility toggle and opacity slider control for MapLibre and deck.gl layers
---

::callout{icon="i-lucide-layers" to="https://mapcn-vue.geoql.in/examples/maplibre-layer-control" target="_blank"}
**Live Demo** - Try the layer control with multiple layer types
::

## Overview

The `VControlLayer` component provides an interactive control for managing layer visibility and opacity. It supports both MapLibre native layers and deck.gl layers, automatically detecting the layer type.

Features:
- Visibility toggle (show/hide layer)
- Opacity slider (0-100%)
- Auto-detection of layer type (MapLibre vs deck.gl)
- Support for fill, line, circle, and symbol layers
- v-model bindings for reactive state management

## Usage

```vue
<script setup lang="ts">
  import { VMap, VControlLayer, VLayerMaplibreGeojson } from '@geoql/v-maplibre';

  const mapOptions = {
    style: 'https://basemaps.cartocdn.com/gl/positron-gl-style/style.json',
    center: [-74.5, 40],
    zoom: 9,
  };

  const geojsonSource = {
    type: 'geojson',
    data: {
      type: 'FeatureCollection',
      features: [
        {
          type: 'Feature',
          geometry: { type: 'Point', coordinates: [-74.5, 40] },
          properties: {},
        },
      ],
    },
  };

  const layerSpec = {
    id: 'points-layer',
    type: 'circle',
    paint: {
      'circle-radius': 10,
      'circle-color': '#007cbf',
    },
  };
</script>

<template>
  <VMap :options="mapOptions" style="height: 500px">
    <VLayerMaplibreGeojson
      source-id="points"
      layer-id="points-layer"
      :source="geojsonSource"
      :layer="layerSpec"
    />
    <VControlLayer
      layer-id="points-layer"
      position="top-right"
      title="Points Layer"
    />
  </VMap>
</template>
```

## Props

### layerId

- **Type:** `string`
- **Required:** `true`

The ID of the layer to control. Must match either a MapLibre layer ID or a deck.gl layer ID.

### position

- **Type:** `'top-left' | 'top-right' | 'bottom-left' | 'bottom-right'`
- **Required:** `false`
- **Default:** `'top-right'`

Position of the control on the map.

### visible

- **Type:** `boolean`
- **Required:** `false`
- **Default:** `true`

Initial visibility state of the layer. Supports v-model binding with `v-model:visible`.

### opacity

- **Type:** `number`
- **Required:** `false`
- **Default:** `1`

Initial opacity of the layer (0-1). Supports v-model binding with `v-model:opacity`.

### title

- **Type:** `string`
- **Required:** `false`
- **Default:** `'Layer Control'`

Title displayed in the control panel.

### layerType

- **Type:** `'maplibre' | 'deckgl'`
- **Required:** `false`
- **Default:** Auto-detected

Force the layer type. If not specified, the component auto-detects whether the layer is a MapLibre or deck.gl layer.

## Events

### @visibility-change

Emitted when the layer visibility changes.

- **Payload:** `boolean`

### @opacity-change

Emitted when the layer opacity changes.

- **Payload:** `number`

### @update:visible

Emitted for v-model:visible binding.

- **Payload:** `boolean`

### @update:opacity

Emitted for v-model:opacity binding.

- **Payload:** `number`

## v-model Bindings

The component supports two-way binding for both visibility and opacity:

```vue
<script setup lang="ts">
  import { ref } from 'vue';

  const isVisible = ref(true);
  const layerOpacity = ref(1);
</script>

<template>
  <VControlLayer
    layer-id="my-layer"
    v-model:visible="isVisible"
    v-model:opacity="layerOpacity"
  />

  <p>Visible: {{ isVisible }}</p>
  <p>Opacity: {{ layerOpacity }}</p>
</template>
```

## Layer Type Support

### MapLibre Layers

For MapLibre native layers, the control automatically maps to the correct opacity property:

| Layer Type | Opacity Property |
|------------|------------------|
| `fill` | `fill-opacity` |
| `line` | `line-opacity` |
| `circle` | `circle-opacity` |
| `symbol` | `icon-opacity` |

### deck.gl Layers

For deck.gl layers, the control uses the layer's `visible` and `opacity` props. The component clones the layer with updated properties using the immutable pattern required by deck.gl.

## With deck.gl Layers

```vue
<script setup lang="ts">
  import { VMap, VControlLayer, VLayerDeckglScatterplot } from '@geoql/v-maplibre';

  const mapOptions = {
    style: 'https://basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json',
    center: [-122.4, 37.8],
    zoom: 11,
  };

  const data = [
    { coordinates: [-122.4, 37.8], size: 100 },
    { coordinates: [-122.5, 37.7], size: 200 },
  ];
</script>

<template>
  <VMap :options="mapOptions" style="height: 500px">
    <VLayerDeckglScatterplot
      id="scatter-layer"
      :data="data"
      :get-position="(d) => d.coordinates"
      :get-radius="(d) => d.size"
      :get-fill-color="[255, 140, 0]"
    />
    <VControlLayer
      layer-id="scatter-layer"
      position="top-left"
      title="Scatter Points"
    />
  </VMap>
</template>
```

## TypeScript

```typescript
import type { ControlPosition, LayerType } from '@geoql/v-maplibre';

// Props interface
interface LayerControlOptions {
  layerId: string;
  position?: ControlPosition;
  visible?: boolean;
  opacity?: number;
  title?: string;
  layerType?: LayerType;
}
```
